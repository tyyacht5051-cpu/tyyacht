import{_ as k,c as r,a as v,b as t,k as u,g as p,w as f,h as N,i as P,t as d,q as y,s as M,v as x,C,F as w,e as _,n as h,p as D,l as b,A as m,m as V,u as K,f as n}from"./index-B24G-8VQ.js";const I={name:"NoticeExemption",setup(){return{toast:K()}},data(){return{authStore:V,searchType:"title",searchKeyword:"",currentPage:1,noticesPerPage:10,imageModal:{show:!1,image:null},notices:[],API_BASE_URL:m}},async mounted(){await this.loadNotices()},computed:{isAdmin(){return this.authStore.state.isAuthenticated&&this.authStore.state.user?.role==="admin"},filteredNotices(){return this.searchKeyword?this.notices.filter(a=>{switch(this.searchType){case"title":return a.title.includes(this.searchKeyword);case"content":return a.content.includes(this.searchKeyword);case"all":return a.title.includes(this.searchKeyword)||a.content.includes(this.searchKeyword);default:return!0}}):this.notices},paginatedNotices(){const a=(this.currentPage-1)*this.noticesPerPage,e=a+this.noticesPerPage;return this.filteredNotices.slice(a,e)},totalPages(){return Math.ceil(this.filteredNotices.length/this.noticesPerPage)},visiblePages(){const a=[];let c=Math.max(1,this.currentPage-Math.floor(2.5)),l=Math.min(this.totalPages,c+5-1);l-c+1<5&&(c=Math.max(1,l-5+1));for(let o=c;o<=l;o++)a.push(o);return a}},methods:{searchNotices(){this.currentPage=1},changePage(a){this.currentPage=a},async loadNotices(){try{const a=await b.get(`${m}/api/notices`,{params:{category:"exemption",limit:100}});this.notices=a.data.map(e=>({...e,date:e.created_at.split("T")[0]}))}catch(a){console.error("ë©´ì œêµìœ¡ ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨:",a),this.toast.error("ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","âš ï¸ ë¡œë“œ ì˜¤ë¥˜")}},async createNewPage(){try{const e=(await b.post(`${m}/api/notices/draft`,{category_id:"exemption",title:"ìƒˆ ê³µì§€ì‚¬í•­",content:"ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."},{headers:{Authorization:`Bearer ${this.authStore.state.token}`}})).data.id;this.$router.push(`/notice/exemption/edit/${e}`)}catch(a){console.error("ìƒˆ í˜ì´ì§€ ìƒì„± ì‹¤íŒ¨:",a),a.response?.status===401?(this.toast.urgent("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.","ğŸ” ë¡œê·¸ì¸ í•„ìš”"),this.$router.push("/login")):a.response?.status===403?this.toast.urgent("ê´€ë¦¬ìë§Œ ê¸€ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.","âš ï¸ ê¶Œí•œ ì—†ìŒ"):this.toast.error("ìƒˆ í˜ì´ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","âŒ ìƒì„± ì‹¤íŒ¨")}},formatDate(a){const e=new Date(a),l=new Date-e,o=Math.floor(l/(1e3*60*60*24));return o===0?"ì˜¤ëŠ˜":o===1?"ì–´ì œ":o<7?`${o}ì¼ ì „`:e.toLocaleDateString("ko-KR")},isNewNotice(a){const e=new Date(a),l=new Date-e;return Math.floor(l/(1e3*60*60*24))<=3},goBack(){this.$router.push("/notice")},openImageModal(a){this.imageModal.show=!0,this.imageModal.image=a},closeImageModal(){this.imageModal.show=!1,this.imageModal.image=null}}},S={class:"notice-exemption"},T={class:"content-section"},A={class:"container"},B={class:"notice-header"},E={class:"breadcrumb"},L={class:"notice-info"},U={class:"total-count"},R={class:"search-section"},z={class:"search-controls"},F={key:0,class:"admin-controls"},q={class:"notices-table"},W={class:"col-number"},j={class:"col-title"},G={key:0,class:"new-badge"},H={class:"col-date"},J={class:"col-views"},O={key:0,class:"empty-state"},Q={key:1,class:"pagination"},X=["onClick"],Y={class:"back-button"},Z=["src","alt"],$={class:"modal-info"};function ee(a,e,c,l,o,i){const g=P("router-link");return n(),r("div",S,[e[15]||(e[15]=v('<section class="hero-section" data-v-321e010a><div class="hero-background" data-v-321e010a></div><div class="hero-overlay" data-v-321e010a></div><div class="hero-content" data-v-321e010a><h1 class="hero-title" data-v-321e010a>ë©´ì œêµìœ¡ ê³µì§€ì‚¬í•­</h1><p class="hero-subtitle" data-v-321e010a>ìš”íŠ¸ë©´í—ˆ ë©´ì œêµìœ¡ ê´€ë ¨ ê³µì§€ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”</p></div></section>',1)),t("section",T,[t("div",A,[t("div",B,[t("div",E,[p(g,{to:"/notice"},{default:f(()=>e[9]||(e[9]=[N("ê³µì§€ì‚¬í•­",-1)])),_:1,__:[9]}),e[10]||(e[10]=t("span",{class:"separator"},">",-1)),e[11]||(e[11]=t("span",{class:"current"},"ë©´ì œêµìœ¡",-1))]),t("div",L,[t("span",U,"ì´ "+d(i.filteredNotices.length)+"ê°œ ê²Œì‹œë¬¼",1)])]),t("div",R,[t("div",z,[y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.searchType=s),class:"search-select"},e[12]||(e[12]=[t("option",{value:"title"},"ì œëª©",-1),t("option",{value:"content"},"ë‚´ìš©",-1),t("option",{value:"all"},"ì „ì²´",-1)]),512),[[M,o.searchType]]),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.searchKeyword=s),type:"text",placeholder:"ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”",class:"search-input",onKeyup:e[2]||(e[2]=C((...s)=>i.searchNotices&&i.searchNotices(...s),["enter"]))},null,544),[[x,o.searchKeyword]]),t("button",{onClick:e[3]||(e[3]=(...s)=>i.searchNotices&&i.searchNotices(...s)),class:"search-btn"},"ê²€ìƒ‰")]),i.isAdmin?(n(),r("div",F,[t("button",{onClick:e[4]||(e[4]=(...s)=>i.createNewPage&&i.createNewPage(...s)),class:"write-btn"},"âœï¸ ê¸€ì“°ê¸°")])):u("",!0)]),t("div",q,[e[13]||(e[13]=v('<div class="table-header" data-v-321e010a><div class="col-number" data-v-321e010a>ë²ˆí˜¸</div><div class="col-title" data-v-321e010a>ì œëª©</div><div class="col-date" data-v-321e010a>ì‘ì„±ì¼</div><div class="col-views" data-v-321e010a>ì¡°íšŒ</div></div>',1)),(n(!0),r(w,null,_(i.paginatedNotices,s=>(n(),r("div",{key:s.id,class:h(["table-row",{"important-row":s.important}])},[t("div",W,d(s.id),1),t("div",j,[p(g,{to:`/notice/exemption/${s.id}`,class:"title-link"},{default:f(()=>[t("span",{class:h(["title-text",{"important-title":s.important}])},d(s.title),3),i.isNewNotice(s.date)?(n(),r("span",G,"NEW")):u("",!0)]),_:2},1032,["to"])]),t("div",H,d(i.formatDate(s.date)),1),t("div",J,d(s.views),1)],2))),128))]),i.filteredNotices.length===0?(n(),r("div",O,e[14]||(e[14]=[t("div",{class:"empty-icon"},"ğŸ“‹",-1),t("h3",null,"ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤",-1),t("p",null,"ê´€ë¦¬ìê°€ ê³§ ì¤‘ìš”í•œ ì†Œì‹ì„ ì „í•´ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.",-1)]))):u("",!0),i.totalPages>1?(n(),r("div",Q,[(n(!0),r(w,null,_(i.visiblePages,s=>(n(),r("button",{onClick:te=>i.changePage(s),key:s,class:h(["page-btn",{active:o.currentPage===s}])},d(s),11,X))),128))])):u("",!0)])]),t("div",Y,[t("button",{onClick:e[5]||(e[5]=(...s)=>i.goBack&&i.goBack(...s)),class:"back-btn"}," â† ê³µì§€ì‚¬í•­ìœ¼ë¡œ ëŒì•„ê°€ê¸° ")]),o.imageModal.show?(n(),r("div",{key:0,class:"image-modal",onClick:e[8]||(e[8]=(...s)=>i.closeImageModal&&i.closeImageModal(...s))},[t("div",{class:"modal-content",onClick:e[7]||(e[7]=D(()=>{},["stop"]))},[t("button",{class:"modal-close",onClick:e[6]||(e[6]=(...s)=>i.closeImageModal&&i.closeImageModal(...s))},"âœ•"),t("img",{src:`${o.API_BASE_URL}${o.imageModal.image.url}`,alt:o.imageModal.image.original_name},null,8,Z),t("div",$,[t("p",null,d(o.imageModal.image.original_name),1)])])])):u("",!0)])}const ae=k(I,[["render",ee],["__scopeId","data-v-321e010a"]]);export{ae as default};
